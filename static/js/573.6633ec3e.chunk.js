"use strict";(self.webpackChunktest_fe=self.webpackChunktest_fe||[]).push([[573],{2573:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var r=n(2791),a=n(5087),s=n(5265),i=n(9290),l=n(3789),o=n(9405),c=n(184);const u=function(e){let{question:t,answer:n,termTrainingProgress:u}=e;const[d,m]=(0,r.useState)("QUESTION");(0,r.useEffect)((()=>{m("QUESTION")}),[t,n]);const g=()=>{m("QUESTION"===d?"ANSWER":"QUESTION")};return(0,c.jsxs)(a.x,{className:"text-center w-100",children:[(0,c.jsxs)("div",{className:"m-2",onClick:g,children:[(0,c.jsx)(s.t,{children:d}),(0,c.jsx)(i.u,{className:"m-2 d-flex align-items-center justify-content-center",style:{minHeight:"5rem"},children:"QUESTION"===d?t:n})]}),(0,c.jsx)(l.B,{className:"text-body-secondary py-1",onClick:g,children:(0,c.jsx)("small",{children:(()=>{const e=u.iterationNumber+1;switch(u.status){case o.q.Learning:return"Learn: iteration ".concat(e);case o.q.Repetition:return"Repeat: iteration ".concat(e);case o.q.Relearning:return"Relearn: back from iteration ".concat(e)}})()})})]})};var d=n(7689),m=n(3585),g=n(2618),f=n(6047),h=n(7316),x=n(1987),N=n(3568),b=n(1415),p=n(8335),w=n(4256),j=n(2238),v=n(8948),k=n(4846),y=n(763),E=n.n(y),R=n(1202);const q=e=>{let{undo:t,className:n}=e;return(0,c.jsxs)(g.u,{className:n,color:"secondary",onClick:t,children:[(0,c.jsx)(k.Z,{icon:w.N,className:"me-2"}),"Undo"]})},D=[{label:"Date added: oldest first",value:"dateAdded"},{label:"Date added: newest first",value:"dateAddedReverse"},{label:"Date last trained: oldest first",value:"lastTrained"},{label:"Date last trained: latest first",value:"lastTrainedReverse"},{label:"Shuffled",value:"random"}],I=(e,t)=>{const n=new Set((0,R.Il)(e)),r={};Array.from(t.entries()).filter((e=>n.has(e[0].name))).forEach((e=>r[e[0].name]=e[1]));return E().template((0,R.tG)(e))(r)};const O=function(){const e=(0,d.s0)(),t=(0,d.TH)(),{trainingName:n,trainingType:a}=t.state,{profile:s}=(0,r.useContext)(p.Z),i=s.trainingDefinitions.find((e=>e.name===n)),l=(0,r.useRef)([]),[w,y]=(0,r.useState)(0),E="lastOrder"+n,R=localStorage.getItem(E)||"dateAdded";console.log("get from local storage: ".concat(E," = ").concat(R));const[O,S]=(0,r.useState)({order:R}),U=(0,r.useMemo)((()=>{if(i){const e=(0,m.f5)(s,i,a);switch(O.order){case"dateAdded":default:return e;case"dateAddedReverse":return e.reverse();case"lastTrained":return e.sort(((e,t)=>(e.lastEditDate||Number.MAX_VALUE)-(t.lastEditDate||Number.MAX_VALUE)));case"lastTrainedReverse":return e.sort(((e,t)=>(t.lastEditDate||Number.MIN_VALUE)-(e.lastEditDate||Number.MIN_VALUE)));case"random":return function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(e)}}}),[s,i,a,O]);if(!i||!U)return"Unknown training";const A=()=>{const e=l.current.pop();e?((0,m.wP)(e,U[w-1],s),y((e=>e-1))):console.error("Cannot undo on empty memo-data. Do nothing.")},C=()=>{l.current.push(null),y((e=>e+1))},L=()=>{l.current.pop(),y((e=>e-1))},T=w>0&&null!==l.current[w-1],Z=()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:[T&&(0,c.jsx)(q,{className:"px-4",undo:A}),!T&&(0,c.jsxs)(g.u,{className:"px-4",color:"secondary",onClick:L,disabled:0===w,children:[(0,c.jsx)(k.Z,{icon:j.u,className:"me-2"}),"Back"]}),(0,c.jsx)("div",{className:"text-body-secondary text-center",children:w<U.length?"".concat(w+1," / ").concat(U.length):"Finished"}),(0,c.jsxs)(g.u,{className:"px-4",color:"info",onClick:C,disabled:w===U.length,children:["Skip",(0,c.jsx)(k.Z,{icon:v.r,className:"ms-2"})]})]}),(0,c.jsx)("div",{className:"w-100 text-center",children:(0,c.jsx)(f.y,{thin:!0,className:"my-3",color:"primary",value:100*w/U.length})})]});if(w>=U.length)return(0,c.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,c.jsx)("div",{children:(0,c.jsx)("div",{className:"text-center",children:(0,c.jsx)("div",{className:"d-inline-block",children:(0,c.jsx)(g.u,{className:"px-4",color:"primary",onClick:()=>e("/dashboard"),children:"To Dashboard"})})})}),(0,c.jsx)("div",{className:"mt-auto",children:Z()})]});const V=U[w],M=V.term,P=M.termDefinition,Q=i.configuration.get(P),_=I(Q.questionPattern,M.attributeValues),B=I(Q.answerPattern,M.attributeValues),H=V.status!==o.q.Relearning,z=()=>{const e=U[w];X(e),(0,m.ot)(U[w],i,s),y((e=>e+1))},F=()=>{const e=U[w];X(e),(0,m.HZ)(U[w],s),y((e=>e+1))},G=()=>{const e=U[w];X(e),(0,m.zd)(U[w],s),y((e=>e+1))},W=()=>{const e=U[w];X(e),(0,m.yZ)(U[w],s),y((e=>e+1))},X=e=>{l.current.push((0,m.bV)(e))},Y=e=>{const t=e.target.value;localStorage.setItem(E,t),console.log("set to local storage: ".concat(E," = ").concat(t)),S({order:t}),y(0),l.current.length=0};return(0,c.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,c.jsx)("div",{children:(0,c.jsx)("div",{className:"row justify-content-center",children:(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-5",children:(0,c.jsxs)("div",{className:"d-flex flex-column gap-3 justify-content-center align-items-center",children:[(0,c.jsxs)(h.Y,{size:"sm",className:"flex-grow-0 mb-2",children:[(0,c.jsx)(x.w,{component:"label",children:"Order:"}),(0,c.jsx)(N.L,{value:O.order,onChange:Y,options:D})]}),(0,c.jsx)(u,{question:_,answer:B,termTrainingProgress:V}),(0,c.jsxs)("div",{className:"d-flex justify-content-between w-100",children:[(0,c.jsxs)(b.Z,{vertical:!0,role:"group","aria-label":"Vertical button group",children:[(0,c.jsx)(g.u,{className:"mb-2 py-2",color:"danger",onClick:G,children:"\u2190 Wrong\xa0\xa0"}),H&&(0,c.jsx)(g.u,{className:"py-2",color:"danger",variant:"outline",onClick:W,children:"Hard"})]}),(0,c.jsxs)(b.Z,{vertical:!0,role:"group","aria-label":"Vertical button group",children:[(0,c.jsx)(g.u,{className:"mb-2 py-2",color:"success",onClick:z,children:"\xa0\xa0Right \u2192"}),H&&(0,c.jsx)(g.u,{className:"py-2",color:"success",variant:"outline",onClick:F,children:"Easy"})]})]})]})})})}),(0,c.jsx)("div",{className:"mt-auto",children:Z()})]})}},3585:(e,t,n)=>{n.d(t,{Ax:()=>h,HZ:()=>o,Pt:()=>l,bV:()=>m,f5:()=>f,ot:()=>u,wP:()=>g,yZ:()=>c,zd:()=>d});var r=n(9405),a=n(7758),s=n(4261);const i=!1;let l=function(e){return e.OnlyNew="onlyNew",e.OnlyRepeat="onlyRepeat",e.All="all",e}({});function o(e,t){switch(e.status){case r.q.Relearning:throw new Error("Unexpected `easy` action for relearning step");case r.q.Learning:e.status=r.q.Repetition,e.iterationNumber=0;break;case r.q.Repetition:e.iterationNumber+=2;break;default:throw new Error("Unknown status: ".concat(e.status))}e.lastEditDate=Date.now(),(0,a.kO)(t)}function c(e,t){if(e.status===r.q.Relearning)throw new Error("Unexpected `hard` action for relearning step");e.lastEditDate=Date.now(),(0,a.kO)(t)}function u(e,t,n){const s=e.iterationNumber;switch(e.status){case r.q.Relearning:e.status=r.q.Repetition,e.iterationNumber=Math.max(0,e.iterationNumber-1);break;case r.q.Learning:s+1>=t.learningIntervals.length?(e.status=r.q.Repetition,e.iterationNumber=0):e.iterationNumber+=1;break;case r.q.Repetition:e.iterationNumber+=1;break;default:throw new Error("Unknown status: ".concat(e.status))}e.lastEditDate=Date.now(),(0,a.kO)(n)}function d(e,t){switch(e.status){case r.q.Relearning:e.status=r.q.Learning,e.iterationNumber=0;break;case r.q.Learning:e.iterationNumber=0;break;case r.q.Repetition:e.status=r.q.Relearning;break;default:throw new Error("Unknown status: ".concat(e.status))}e.lastEditDate=Date.now(),(0,a.kO)(t)}function m(e){return{...e}}function g(e,t,n){t.status=e.status,t.lastEditDate=e.lastEditDate,t.iterationNumber=e.iterationNumber,(0,a.kO)(n)}function f(e,t,n){let a=e.trainingProgresses.get(t);a||(a={progress:new Map},e.trainingProgresses.set(t,a));let i=a.progress,o=Date.now();return e.terms.filter((e=>!e.isBacklog)).filter((e=>t.configuration.has(e.termDefinition))).map((e=>{let t=i.get(e);return t||(t={id:(0,s.Z)(),status:r.q.Learning,term:e,iterationNumber:0,lastEditDate:void 0},i.set(e,t)),t})).filter((e=>{switch(n){case l.OnlyNew:return e.status===r.q.Learning||e.status===r.q.Relearning;case l.OnlyRepeat:return e.status===r.q.Repetition}return!0})).filter((e=>h(e,t,o).doNeed))}function h(e,t,n){const a=e.lastEditDate;if(!a)return{doNeed:!0,remainingDelayBeforeStart:0};let s=function(e,t){var n;switch(t.status){case r.q.Relearning:return x(null!==(n=e.learningIntervals[e.learningIntervals.length-1])&&void 0!==n?n:0);case r.q.Learning:return x(N(e.learningIntervals,t.iterationNumber));case r.q.Repetition:return function(e){if(i)return 6e4;return 1e3*e*60*60*24}(N(e.repetitionIntervals,t.iterationNumber))}}(t,e);const l=a+s-n;return{doNeed:l<=0,remainingDelayBeforeStart:l}}function x(e){return i?3e4:1e3*e*60}function N(e,t){return 0===e.length?0:t<0?e[0]:t>=e.length?e[e.length-1]:e[t]}},1202:(e,t,n)=>{function r(e){const t=e.match(/\{([^}]+)\}/g);return t?t.map((e=>e.slice(1,-1))):[]}function a(e){return e.replace(/\{/g,"<%= ").replace(/\}/g," %>")}function s(e){return null===e||e.length<=0||""===e.trim()}n.d(t,{Il:()=>r,Qc:()=>s,tG:()=>a})}}]);
//# sourceMappingURL=573.6633ec3e.chunk.js.map